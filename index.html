<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pok√©Club: Unova Journey</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
    <style>
        .bg-unova { background-color: #f8fafc; background-image: radial-gradient(#cbd5e1 1px, transparent 1px); background-size: 24px 24px; }
        .tab-active { border-bottom: 3px solid #ef4444; color: #ef4444; font-weight: 900; }
        .gts-step { border-left: 2px solid #ef4444; padding-left: 1rem; margin-bottom: 1rem; }
    </style>
</head>
<body class="bg-unova min-h-screen font-sans text-slate-900 pb-10">

    <header class="bg-slate-900 text-white p-4 shadow-xl sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-black tracking-tighter flex items-center gap-2">
                <i data-lucide="shield-check" class="text-red-500"></i> POK√âCLUB
            </h1>
            <div class="flex gap-2">
                <button onclick="changeTab('gts')" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-[10px] font-bold uppercase tracking-widest transition">
                    GTS
                </button>
                <button onclick="toggleModal('modal-regras')" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-[10px] font-bold uppercase tracking-widest transition">
                    Regras
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 max-w-2xl">
        
        <section class="mb-6 bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
            <h2 class="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-8 flex items-center gap-2">
                <i data-lucide="map" class="w-3"></i> Jornada do Grupo (Semana 1)
            </h2>
            <div class="relative flex justify-between px-2">
                <div class="absolute top-5 left-0 w-full h-1 bg-slate-100 z-0"></div>
                <div class="relative z-10 flex flex-col items-center w-1/3">
                    <div class="w-10 h-10 bg-white border-4 border-slate-900 rounded-full flex items-center justify-center mb-2"><i data-lucide="home" class="w-4"></i></div>
                    <span class="text-[9px] font-bold uppercase">Nuvema</span>
                    <div id="list-nuvema" class="flex flex-wrap justify-center gap-1 mt-3 min-h-[40px]"></div>
                </div>
                <div class="relative z-10 flex flex-col items-center w-1/3">
                    <div class="w-10 h-10 bg-white border-4 border-slate-400 rounded-full flex items-center justify-center mb-2"><i data-lucide="trees" class="w-4"></i></div>
                    <span class="text-[9px] font-bold uppercase">Rotas 1/2</span>
                    <div id="list-rotas" class="flex flex-wrap justify-center gap-1 mt-3 min-h-[40px]"></div>
                </div>
                <div class="relative z-10 flex flex-col items-center w-1/3">
                    <div class="w-10 h-10 bg-white border-4 border-red-600 rounded-full flex items-center justify-center mb-2 animate-pulse"><i data-lucide="medal" class="w-4 text-red-600"></i></div>
                    <span class="text-[9px] font-bold uppercase text-red-600">Gin√°sio 1</span>
                    <div id="list-ginasio" class="flex flex-wrap justify-center gap-1 mt-3 min-h-[40px]"></div>
                </div>
            </div>
        </section>

        <section class="bg-white rounded-3xl shadow-xl overflow-hidden border border-slate-200">
            <div class="bg-slate-50 border-b p-4 flex justify-around">
                <button onclick="changeTab('perfil')" id="tab-perfil" class="text-[10px] font-bold uppercase pb-1 tab-active">Perfil</button>
                <button onclick="changeTab('pokedex')" id="tab-pokedex" class="text-[10px] font-bold uppercase pb-1 text-slate-400">Dex/Time</button>
                <button onclick="changeTab('gts')" id="tab-gts" class="text-[10px] font-bold uppercase pb-1 text-slate-400">Tutorial GTS</button>
            </div>

            <div id="content-perfil" class="p-6 space-y-4">
                <input type="text" id="nome" class="w-full border-2 border-slate-100 p-3 rounded-2xl outline-none font-medium" placeholder="Seu Nome">
                <div class="grid grid-cols-2 gap-3">
                    <select id="versao" class="w-full border-2 border-slate-100 p-3 rounded-2xl bg-white text-sm">
                        <option value="Black">Pok√©mon Black</option>
                        <option value="White">Pok√©mon White</option>
                    </select>
                    <select id="inicial" onchange="renderTeamInputs()" class="w-full border-2 border-slate-100 p-3 rounded-2xl bg-white text-sm">
                        <option value="Snivy">Snivy üçÉ</option>
                        <option value="Tepig">Tepig üî•</option>
                        <option value="Oshawott">Oshawott üíß</option>
                    </select>
                </div>
                <select id="progresso" class="w-full border-2 border-slate-100 p-4 rounded-2xl bg-slate-900 text-white font-bold">
                    <option value="nuvema">üè† Nuvema Town (In√≠cio)</option>
                    <option value="rotas">üåø Rota 1 ou 2</option>
                    <option value="ginasio">üèÖ Venci o 1¬∫ Gin√°sio!</option>
                </select>
                <button onclick="changeTab('pokedex')" class="w-full py-2 text-blue-500 text-[10px] font-bold uppercase tracking-widest">Pr√≥ximo: Atualizar Time ‚ûî</button>
            </div>

            <div id="content-pokedex" class="hidden p-6 space-y-6">
                <h3 class="text-xs font-black uppercase text-slate-400 tracking-widest">Pok√©dex (Capturados)</h3>
                <div id="pokedex-grid" class="grid grid-cols-2 gap-2"></div>
                <div class="border-t pt-6">
                    <h3 class="text-xs font-black uppercase text-slate-400 mb-3 tracking-widest">Equipe Atual</h3>
                    <div id="team-list" class="space-y-2"></div>
                </div>
                <button onclick="salvarTudo()" id="btn-final" class="w-full bg-red-600 text-white font-black py-4 rounded-2xl shadow-lg active:scale-95 transition">SALVAR JORNADA</button>
            </div>

            <div id="content-gts" class="hidden p-6 space-y-4">
                <h2 class="text-lg font-black text-slate-900 border-b pb-2">Como conectar ao GTS (PKMN Classic)</h2>
                <div class="text-sm text-slate-600 space-y-4">
                    <div class="gts-step">
                        <p class="font-bold text-slate-900">1. V√° nas Configura√ß√µes de Wi-Fi</p>
                        <p>No menu do jogo ou do seu DS/Emulador, acesse as configura√ß√µes de conex√£o Nintendo WFC.</p>
                    </div>
                    <div class="gts-step">
                        <p class="font-bold text-slate-900">2. DNS Prim√°rio</p>
                        <p>Mude o "Auto-obtain DNS" para <strong class="text-red-600">NO</strong>.</p>
                        <p>Insira o DNS: <code class="bg-slate-100 px-2 py-1 rounded font-bold">178.62.43.212</code></p>
                    </div>
                    <div class="gts-step">
                        <p class="font-bold text-slate-900">3. DNS Secund√°rio</p>
                        <p>Deixe como <code class="bg-slate-100 px-2 py-1 rounded">0.0.0.0</code> ou <code class="bg-slate-100 px-2 py-1 rounded">1.1.1.1</code>.</p>
                    </div>
                    <div class="gts-step">
                        <p class="font-bold text-slate-900">4. Pronto!</p>
                        <p>Salve e entre no GTS dentro de qualquer Centro Pok√©mon (andar de cima). Agora voc√™ pode trocar com o grupo!</p>
                    </div>
                    <p class="text-[10px] bg-amber-50 p-2 border border-amber-200 rounded text-amber-800 italic">
                        Nota: Se estiver no emulador, verifique se ele suporta conex√£o WFC. No DS original, use uma rede Wi-Fi sem senha ou com seguran√ßa WEP.
                    </p>
                </div>
                <button onclick="changeTab('perfil')" class="w-full py-2 text-slate-400 text-[10px] font-bold uppercase tracking-widest">Voltar para o App</button>
            </div>
        </section>
    </main>

    <div id="modal-regras" class="hidden fixed inset-0 bg-slate-900/95 flex items-center justify-center p-6 z-[100]">
        <div class="bg-white rounded-[2rem] max-w-md w-full p-8 shadow-2xl">
            <h2 class="text-2xl font-black mb-6">REGRAS DO CLUBE</h2>
            <div class="text-sm text-slate-600 space-y-3">
                <p>‚Ä¢ <strong>Meta:</strong> At√© o 1¬∫ Gin√°sio (23/02 - 01/03).</p>
                <p>‚Ä¢ <strong>GTS:</strong> Troque exclusivos com o grupo usando o DNS acima!</p>
                <p>‚Ä¢ <strong>Spoiler:</strong> Proibido comentar eventos futuros.</p>
                <p>‚Ä¢ <strong>Legitimidade:</strong> Vers√µes originais (sem mods/hacks).</p>
            </div>
            <button onclick="toggleModal('modal-regras')" class="mt-8 w-full bg-slate-900 text-white py-4 rounded-2xl font-black uppercase">Fechar</button>
        </div>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://clube-pokemon-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        lucide.createIcons();

        const pokesDisponiveis = ["Patrat", "Lillipup", "Purrloin", "Pansage", "Pansear", "Panpour", "Munna", "Roggenrola", "Woobat", "Audino"];
        let capturados = [];
        let teamData = {};

        const dexGrid = document.getElementById('pokedex-grid');
        pokesDisponiveis.forEach(pk => {
            dexGrid.innerHTML += `<label class="flex items-center gap-2 border p-2 rounded-xl cursor-pointer text-xs"><input type="checkbox" onchange="updateDex(this)" value="${pk}"> ${pk}</label>`;
        });

        function changeTab(tab) {
            ['perfil', 'pokedex', 'gts'].forEach(t => {
                document.getElementById('content-' + t).classList.toggle('hidden', t !== tab);
                document.getElementById('tab-' + t).classList.toggle('tab-active', t === tab);
                if(t !== tab) document.getElementById('tab-' + t).classList.add('text-slate-400');
                else document.getElementById('tab-' + t).classList.remove('text-slate-400');
            });
        }

        function toggleModal(id) { document.getElementById(id).classList.toggle('hidden'); }

        function updateDex(el) {
            if(el.checked) { capturados.push(el.value); teamData[el.value] = 1; } 
            else { capturados = capturados.filter(p => p !== el.value); delete teamData[el.value]; }
            renderTeamInputs();
        }

        function renderTeamInputs() {
            const container = document.getElementById('team-list');
            const inicial = document.getElementById('inicial').value;
            container.innerHTML = "";
            const list = [inicial, ...capturados].slice(0, 6);
            list.forEach(pk => {
                if(!teamData[pk]) teamData[pk] = 5;
                container.innerHTML += `<div class="flex items-center justify-between bg-slate-50 p-2 rounded-xl border">
                    <span class="text-xs font-bold">${pk}</span>
                    <input type="number" value="${teamData[pk]}" onchange="teamData['${pk}'] = this.value" class="w-12 border text-center text-xs font-bold">
                </div>`;
            });
        }

        function salvarTudo() {
            const nome = document.getElementById('nome').value.trim();
            if(!nome) return alert("Digite seu nome!");
            const btn = document.getElementById('btn-final');
            btn.innerText = "SALVANDO...";
            db.ref('jogadores/' + nome).set({
                nome, versao: document.getElementById('versao').value,
                inicial: document.getElementById('inicial').value,
                progresso: document.getElementById('progresso').value,
                capturados, team: Object.entries(teamData).map(([species, level]) => ({species, level})),
                updateAt: Date.now()
            }).then(() => { btn.innerText = "SALVAR JORNADA"; alert("Sucesso!"); changeTab('perfil'); });
        }

        db.ref('jogadores').on('value', (snap) => {
            ['list-nuvema', 'list-rotas', 'list-ginasio'].forEach(id => document.getElementById(id).innerHTML = "");
            const data = snap.val();
            if(data) {
                Object.values(data).forEach(p => {
                    const color = p.versao === 'Black' ? 'bg-slate-900 text-white' : 'bg-white border text-slate-900';
                    document.getElementById('list-' + p.progresso).innerHTML += `
                        <div class="group relative">
                            <div class="w-8 h-8 rounded-full ${color} text-[9px] flex items-center justify-center font-black shadow-sm cursor-pointer">${p.nome.substring(0,2).toUpperCase()}</div>
                            <div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 scale-0 group-hover:scale-100 transition-all z-50">
                                <div class="bg-slate-900 text-white text-[10px] p-2 rounded-xl shadow-2xl min-w-[100px]">
                                    <p class="font-bold border-b border-slate-700 mb-1">${p.nome}</p>
                                    <p>Time: ${p.team ? p.team.map(t => t.species).join(', ') : ''}</p>
                                </div>
                            </div>
                        </div>`;
                });
            }
        });
        renderTeamInputs();
    </script>
</body>
</html>
